å›æµ‹åŒºé—´: 2020-01-01 - 2024-06-01
æœŸåˆèµ„äº§: 1000000.00
æœŸæœ«èµ„äº§: 3026700.17
å¹´åŒ–æ”¶ç›Š: 28.29%
å¹´åŒ–æ³¢åŠ¨: 25.26%
æœ€å¤§å›æ’¤: 22.03%
å¤æ™®æ¯”: 1.12

## æŒ‘æˆ˜å¤ç°80ç¯‡é‡åŒ–è®ºæ–‡ç¬¬42æœŸ-åŸæ²¹é¢„æµ‹è‚¡ç¥¨å›æŠ¥
å›æµ‹åŒºé—´: 2020-01-01 - 2024-06-01
æœŸåˆèµ„äº§: 1000000.00
æœŸæœ«èµ„äº§: 3026700.17
å¹´åŒ–æ”¶ç›Š: 28.29%
å¹´åŒ–æ³¢åŠ¨: 25.26%
æœ€å¤§å›æ’¤: 22.03%
å¤æ™®æ¯”: 1.12
### ç­–ç•¥æ¦‚è¿° ğŸ’¡
æœ¬ç­–ç•¥åŸºäºåŸæ²¹ä»·æ ¼é¢„æµ‹è‚¡å¸‚è¡¨ç°ã€‚ç ”ç©¶è¡¨æ˜ï¼ŒåŸæ²¹ä»·æ ¼ä¸æœªæ¥è‚¡ç¥¨å›æŠ¥å­˜åœ¨è´Ÿç›¸å…³å…³ç³»ã€‚è¾ƒé«˜çš„åŸæ²¹ä»·æ ¼é¢„ç¤ºç€æœªæ¥è‚¡ç¥¨å›æŠ¥è¾ƒä½ï¼Œåä¹‹äº¦ç„¶ã€‚

### å…³é”®è¦ç‚¹ âœ¨
æœ¬ç­–ç•¥ä¾èµ–äºæŠ•èµ„è€…å¯¹åŸæ²¹ä»·æ ¼å˜åŠ¨çš„ååº”æ»åæ€§ã€‚è¿™ç§æ»åæ€§å¯èƒ½æ˜¯å› ä¸ºæŠ•èµ„è€…éš¾ä»¥è¯„ä¼°åŸæ²¹ä»·æ ¼å˜åŒ–å¯¹è‚¡ç¥¨ä»·å€¼çš„å½±å“ï¼Œæˆ–æŠ•èµ„è€…åœ¨ä¸åŒæ—¶é—´ç‚¹å¯¹ä¿¡æ¯ä½œå‡ºååº”ã€‚

### äº¤æ˜“èµ„äº§ ğŸ“¦
æœ¬ç­–ç•¥ä½¿ç”¨é˜¿æ‹‰ä¼¯è½»è´¨åŸæ²¹ä»·æ ¼ä½œä¸ºä¸»è¦ç‹¬ç«‹å˜é‡ï¼Œæœˆåº¦è‚¡å¸‚å›æŠ¥ä½œä¸ºä¾èµ–å˜é‡ã€‚

### äº¤æ˜“ç­–ç•¥ ğŸ› ï¸
æ¯æœˆé‡æ–°ä¼°è®¡å›å½’æ¨¡å‹ï¼Œæ–°å¢ä¸Šæœˆæ•°æ®ã€‚æ ¹æ®å›å½’ç»“æœåˆ¤æ–­å½“æœˆé¢„æœŸè‚¡ç¥¨å¸‚åœºå›æŠ¥æ˜¯å¦é«˜äºæ— é£é™©åˆ©ç‡ã€‚

### äº¤æ˜“ä¿¡å· ğŸ“¢
- è‹¥é¢„æœŸå›æŠ¥é«˜äºæ— é£é™©åˆ©ç‡ï¼ŒæŠ•èµ„è€…å…¨é¢æŠ•èµ„äºå¸‚åœºç»„åˆï¼ˆç‰›å¸‚ï¼‰ã€‚
- è‹¥é¢„æœŸå›æŠ¥ä½äºæ— é£é™©åˆ©ç‡ï¼ŒæŠ•èµ„è€…æŠ•èµ„äºç°é‡‘ï¼ˆç†Šå¸‚ï¼‰ã€‚

### è®ºæ–‡å‡ºå¤„ ğŸ“š
- Nonejad, Nima. "Equity premium prediction using the price of crude oil: Uncovering the nonlinear predictive impact." Energy Economics, 2022, vol. 115, issue C.
- QuantPedia. "Crude Oil Predicts Equity Returns."


```Python
import backtrader as bt
import yfinance as yf
import pandas as pd
import numpy as np
import warnings
warnings.filterwarnings('ignore')

class CrudeOilPredictor(bt.Strategy):
    def __init__(self):
        self.oil_data = self.datas[0]
        self.equity_data = self.datas[1]
        self.last_month = -1

    def next(self):
        current_month = self.data.datetime.date(0).month
        if current_month == self.last_month:
            return

        self.last_month = current_month
        oil_returns = (self.oil_data.close[0] / self.oil_data.close[-21]) - 1
        equity_returns = (self.equity_data.close[0] / self.equity_data.close[-21]) - 1

        # Perform regression
        X = np.array(oil_returns).reshape(-1, 1)
        y = np.array(equity_returns).reshape(-1, 1)
        regression = np.linalg.lstsq(X, y, rcond=None)[0]
        expected_return = regression[0][0] * oil_returns

        risk_free_rate = 0.0003  # å‡è®¾æ— é£é™©åˆ©ç‡ä¸º0.03%ï¼ˆæ¯æœˆï¼‰
        if expected_return > risk_free_rate:
            self.order_target_percent(target=1.0)
        else:
            self.order_target_percent(target=0.0)

    def log(self, txt, dt=None):
        dt = dt or self.datas[0].datetime.date(0)
        print(f'{dt.isoformat()} {txt}')

class PerformanceAnalyzer(bt.Analyzer):
    def __init__(self):
        self.rets = []

    def next(self):
        self.rets.append(self.strategy.broker.getvalue())

    def get_analysis(self):
        returns = np.diff(self.rets) / self.rets[:-1]
        annual_return = np.mean(returns) * 252
        annual_volatility = np.std(returns) * np.sqrt(252)
        sharpe_ratio = annual_return / annual_volatility

        cum_returns = np.maximum.accumulate(self.rets)
        drawdowns = (cum_returns - self.rets) / cum_returns
        max_drawdown = np.max(drawdowns)

        return {
            'portfolio_value': self.rets[-1],
            'annual_return': annual_return,
            'annual_volatility': annual_volatility,
            'sharpe_ratio': sharpe_ratio,
            'max_drawdown': max_drawdown
        }

if __name__ == '__main__':
    cerebro = bt.Cerebro()
    
    oil_data = bt.feeds.PandasData(dataname=yf.download('CL=F', start="2020-01-01", end="2024-06-01"))
    equity_data = bt.feeds.PandasData(dataname=yf.download('SPY', start="2020-01-01", end="2024-06-01"))

    cerebro.adddata(oil_data, name='Oil')
    cerebro.adddata(equity_data, name='Equity')

    cerebro.addstrategy(CrudeOilPredictor)
    cerebro.broker.set_cash(1000000)
    cerebro.broker.setcommission(commission=0.0)  # è®¾ç½®æ— äº¤æ˜“ä½£é‡‘

    cerebro.addanalyzer(PerformanceAnalyzer, _name='performance')

    print('æœŸåˆèµ„äº§: %.2f' % cerebro.broker.getvalue())
    results = cerebro.run()
    strat = results[0]
    print('å›æµ‹åŒºé—´: 2020-01-01 - 2024-06-01')
    print('æœŸåˆèµ„äº§: %.2f' % 1000000)
    print('æœŸæœ«èµ„äº§: %.2f' % cerebro.broker.getvalue())

    performance = strat.analyzers.performance.get_analysis()
    print('å¹´åŒ–æ”¶ç›Š: {:.2f}%'.format(performance['annual_return'] * 100))
    print('å¹´åŒ–æ³¢åŠ¨: {:.2f}%'.format(performance['annual_volatility'] * 100))
    print('æœ€å¤§å›æ’¤: {:.2f}%'.format(performance['max_drawdown'] * 100))
    print('å¤æ™®æ¯”: {:.2f}'.format(performance['sharpe_ratio']))

    cerebro.plot()

```